{"pages":[],"posts":[{"title":"Windows 10 Docker Container 時間校正","text":"前言由於在 Container 的環境內開發、測試，常常一開機就啟動一個工作站 Docker Image，放到下次電腦重新開機才會需要再次啟動 Image。通常都不會有問題，但遇到需要驗證時間的需求時（如 JWT Token 驗證），就會比較麻煩了。 發生原因Container 在啟動時不會有時間不同步的問題。問題發生在 Windows 休眠喚醒之後，Windows 會自動校正時間，但 Container 會從休眠當下的時間繼續往下走。如果電腦來回休眠個幾次，時間就會差到好幾小時甚至好幾天了。 解法 Windows 10 有 Hyper-V 管理員 ，可以從左下角搜尋中找到 進去後選擇 DockerVM ，點選右邊的 設定 裡面的整合服務，如果原本 時間同步化 沒有勾選，勾選後套用 如果本來就勾選了，先取消套用後，勾選再套用 不需要重新啟動 Container 在裡面重新驗證一次時間就會恢復正常","link":"/2020/04/16/windows-docker-time-correction/"},{"title":"Mocha 與 Babel7 搭配執行 Unit Test","text":"前言許多專案不論前後端都開始使用 ES6 的語法，但是 Mocha 在平常情況下還是不支援 Module 的。如果要讓單元測試可以順利在專案內運行，需要搭配 Babel 一起使用。 安裝步驟12yarn add --dev mocha chaiyarn add --dev @babel/register 使用方式在 package.json 內的 scripts 加入 123&quot;scripts&quot;: { &quot;test&quot;: &quot;./node_modules/.bin/mocha --require @babel/register --recursive ./tests/&quot;} 採雷官網說明如果用 Node13 以下的版本，又希望可以套用 Module 時可以增加參數 --experimental-modules但經過實測有點問題：Mocha 會自行嘗試安裝一些套件，但以我的專案為例裝到一半就噴錯了，也看不出所以然。而且 package.json 還要加入 type module 說明專案性質，應該是還在實驗階段。 說明 之前的做法 --compilers js:@babel/register 已經被 Deprecated，要改用 --require 需要這樣做主要是要用 babel 協助轉譯。如果本來的寫法就是用如 require() 等 ES6 以前的寫法就不需要額外增加參數","link":"/2020/04/19/mocha-babel7/"},{"title":"圖片格式轉換","text":"前言圖片格式轉換一直是大多數人會遇到的問題，雖然幫忙轉換的網站很多，也都能免費使用。但如果想用程式處理就不是這麼方便了，尤其網路品質也會影響處理的速度，檔案大的時候慢起來也是花上不少時間。雖然本機安裝 imagemagick 就能解決，但包成 docker 能避免本機環境越來越胖也可以藉由仲介層慢慢加入一些邏輯進去，就決定這樣做了。 簡介Github Repo - go-image-converter目前能做的事情很單純，把檔案丟進去後就會回傳指定的格式。 Github 裡面有更詳細的說明 回傳範例 小結golang 雖然不是目前的主力開發語言，但它滿適合應用在微服務的架構內。 效能不錯 自身就能夠啟動伺服器，不需要 Apache 或 Nginx 在前面做代理 編譯後執行檔不會太大 備註 範例圖檔使用 unsplash-logoThomas Tucker","link":"/2020/04/26/go-image-converter/"}],"tags":[{"name":"Windows10","slug":"Windows10","link":"/tags/Windows10/"},{"name":"TimeCorrection","slug":"TimeCorrection","link":"/tags/TimeCorrection/"},{"name":"UnitTest","slug":"UnitTest","link":"/tags/UnitTest/"},{"name":"Mocha","slug":"Mocha","link":"/tags/Mocha/"},{"name":"Babel7","slug":"Babel7","link":"/tags/Babel7/"},{"name":"Golang","slug":"Golang","link":"/tags/Golang/"},{"name":"imagemagick","slug":"imagemagick","link":"/tags/imagemagick/"},{"name":"圖片格式轉換","slug":"圖片格式轉換","link":"/tags/%E5%9C%96%E7%89%87%E6%A0%BC%E5%BC%8F%E8%BD%89%E6%8F%9B/"},{"name":"HEIC to JPG","slug":"HEIC-to-JPG","link":"/tags/HEIC-to-JPG/"}],"categories":[{"name":"Coding","slug":"Coding","link":"/categories/Coding/"},{"name":"Docker","slug":"Coding/Docker","link":"/categories/Coding/Docker/"},{"name":"Node","slug":"Coding/Node","link":"/categories/Coding/Node/"}]}